<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/aiva-favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SSO Portal - Query Parameter Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        color: white;
        min-height: 100vh;
        margin: 0;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.1);
        padding: 2rem;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .header {
        text-align: center;
        margin-bottom: 2rem;
      }
      .logo {
        width: 80px;
        height: 80px;
        background: white;
        border-radius: 50%;
        margin: 0 auto 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        color: #1e3c72;
        font-weight: bold;
      }
      .test-section {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 5px;
        background: rgba(255, 255, 255, 0.05);
      }
      .btn {
        background: #28a745;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin: 5px;
        text-decoration: none;
        display: inline-block;
        transition: background 0.3s;
      }
      .btn:hover {
        background: #218838;
      }
      .btn-primary {
        background: #007bff;
      }
      .btn-primary:hover {
        background: #0056b3;
      }
      .code-block {
        background: rgba(0, 0, 0, 0.3);
        padding: 10px;
        border-radius: 3px;
        font-family: monospace;
        margin: 10px 0;
        word-break: break-all;
      }
      .info {
        background: rgba(23, 162, 184, 0.2);
        border: 1px solid rgba(23, 162, 184, 0.5);
        padding: 10px;
        border-radius: 5px;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="logo">P</div>
        <h1>SSO Portal - Query Parameter Test</h1>
        <p>Testing JWT token via URL query parameter</p>
      </div>

      <div class="test-section">
        <h3>üìã User Information</h3>
        <div class="info">
          <strong>Employee ID:</strong> 7780<br />
          <strong>Name:</strong> WAHYU EDI SANTOSO<br />
          <strong>Username:</strong> wahyu.santoso<br />
          <strong>Email:</strong> 1930.7780@peruri.co.id<br />
          <strong>Authority:</strong> HUKUM
        </div>
      </div>

      <div class="test-section">
        <h3>üîó Direct URL with Token</h3>
        <p>This URL includes the access_token as a query parameter:</p>
        <div class="code-block" id="token-url"></div>
        <button class="btn btn-primary" onclick="copyUrl()">üìã Copy URL</button>
        <a href="#" class="btn" id="direct-link" target="_blank">üöÄ Open Chat Bot with Token</a>
      </div>

      <div class="test-section">
        <h3>‚öôÔ∏è How It Works</h3>
        <p>The new implementation:</p>
        <ol>
          <li>Chat bot checks for <code>access_token</code> query parameter</li>
          <li>If found, decodes the JWT token</li>
          <li>Extracts user profile and authority from token</li>
          <li>Stores authentication data in localStorage</li>
          <li>Removes token from URL for security</li>
          <li>Redirects to main chat interface</li>
        </ol>
      </div>

      <div class="test-section">
        <h3>üß™ Test Steps</h3>
        <ol>
          <li>Click "Open Chat Bot with Token" button above</li>
          <li>Watch browser console for debug messages</li>
          <li>Verify user is authenticated with correct authority</li>
          <li>Create a chat session and check database for user_id = "7780"</li>
        </ol>
      </div>
    </div>

    <script>
      // Same JWT token as before
      const SAMPLE_TOKEN =
        'eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIyZTBmNjkzOC05ODU4LTQwZDgtOTczMy1kN2FhMmZkZjFmMGMifQ.eyJleHAiOjE3NTU2OTY5MDAsImlhdCI6MTc1NTY5NjE4MCwianRpIjoiNWYxODZjMmEtN2Y5MS00MmZjLWE3ODEtZTZjNjFlOTJlNGJkIiwiaXNzIjoiaHR0cHM6Ly8xMC4zMC4xMS4xNjc6NDQ0NC9yZWFsbXMvcGVydXJpIiwiYXVkIjpbIm9tdGktcGVydXJpIiwicmVhbG0tbWFuYWdlbWVudCIsImRzcy1wZXJ1cmkiLCJxdW1vbi1wZXJ1cmkiLCJraW5lcmpha3UtcGVydXJpIiwiYnJva2VyIiwiZXNzLXBlcnVyaSIsInNpZGlhLW1pY3Jvc2VydmljZXMtcGVydXJpIiwicG9ydGFsLXBlcnVyaSIsInNpaGVwaS1zc28iLCJhZG1pbi1jbGkiLCJkdW1teV9wcm9qZWN0IiwiYWNjb3VudCIsImVpbnZvaWNlLXBlcnVyaSIsIm1vbml0b3JpbmctcGVydXJpIl0sInN1YiI6ImUzOTY4ZGU3LTdmNjUtNDY0OC05M2QzLTllYjE3NjllMDgyMiIsInR5cCI6IkJlYXJlciIsImF6cCI6ImFpdmEtcGVydXJpIiwic2Vzc2lvbl9zdGF0ZSI6IjEwNDRhOGViLTI2NzItNDE4Ni04ZmMyLTI2NDI5YTdiYWFkZCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2xvY2FsaG9zdCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtcGVydXJpIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsib210aS1wZXJ1cmkiOnsicm9sZXMiOlsiYWRtaW4gZGVwYXJ0ZW1lbiJdfSwicmVhbG0tbWFuYWdlbWVudCI6eyJyb2xlcyI6WyJ2aWV3LWlkZW50aXR5LXByb3ZpZGVycyIsInZpZXctcmVhbG0iLCJtYW5hZ2UtaWRlbnRpdHktcHJvdmlkZXJzIiwiaW1wZXJzb25hdGlvbiIsInJlYWxtLWFkbWluIiwiY3JlYXRlLWNsaWVudCIsIm1hbmFnZS11c2VycyIsInF1ZXJ5LXJlYWxtcyIsInZpZXctYXV0aG9yaXphdGlvbiIsInF1ZXJ5LWNsaWVudHMiLCJxdWVyeS11c2VycyIsIm1hbmFnZS1ldmVudHMiLCJtYW5hZ2UtcmVhbG0iLCJ2aWV3LWV2ZW50cyIsInZpZXctdXNlcnMiLCJ2aWV3LWNsaWVudHMiLCJtYW5hZ2UtYXV0aG9yaXphdGlvbiIsIm1hbmFnZS1jbGllbnRzIiwicXVlcnktZ3JvdXBzIl19LCJkc3MtcGVydXJpIjp7InJvbGVzIjpbImRhdGEgYW5hbGlzIHNidSB1YW5nIiwiUXVtb24iLCJJbnRlcm5hbCBTUEkiLCJkYXRhIGFuYWxpcyBwZW5nZW1iYW5nYW4gdXNhaGEiLCJkYXRhIGFuYWxpcyBzYnUgbm9uIHVhbmciLCJEYXRhIEFuYWxpcyBTUEkiLCJLZXNlaGF0YW4iLCJkYXRhIGFuYWxpcyBkYWZhc3VtIiwiZGF0YSBhbmFsaXMgcHJvYmlzIGludGVybmFzaW9uYWwiLCJzdXBlciBhZG1pbiIsIlRhc2tmb3JjZSBDb3ZpZCIsIlN1bW1hcnkiLCJTaW1hbmRvciIsIklUT0MgUGVydXJpIl19LCJhaXZhLXBlcnVyaSI6eyJyb2xlcyI6WyJodWt1bSIsImFkbWluIl19LCJxdW1vbi1wZXJ1cmkiOnsicm9sZXMiOlsiU2Vrc2kgQ2V0c29ydWdhbSIsIkFkbWluIFBLUCBVdGFzIiwiRGVwZGFsaXRhcyIsIlZpZXdlciBVZ2FtIiwiU3VwZXIgQWRtaW4iLCJTYWlwYXJzaWFsIExpbmkgQiIsIlBLUCBVZ2FtIiwiU2FpIFBhcnNpYWwgTGluaSBBIiwiS2hhenNhaSBMaW5pIEIiLCJLaGF6c2FpIExpbmkgQSIsIlNla3NpIFBLUCIsIkFkbWluIFJpa3NhciIsIlZpZXdlciBVdGFzIiwiS2hhemN1dGFzIExpbmkgQSIsIkN1dHBhayBMaW5pIEEiLCJLaGF6Y3V0YXMgTGluaSBCIiwiU2Vrc2kgS2hhenByb2R1Z2FtIiwiQ3V0cGFrIExpbmkgQiIsIlBQSUMiXX0sImtpbmVyamFrdS1wZXJ1cmkiOnsicm9sZXMiOlsiUGVuZ2d1bmEiXX0sImJyb2tlciI6eyJyb2xlcyI6WyJyZWFkLXRva2VuIl19LCJlc3MtcGVydXJpIjp7InJvbGVzIjpbIlBldHVnYXMgUGFtc2lrbmlsbWF0XHJcbiIsIktvbWFuZGFuIFBvc2tvIiwiQWRtaW4gUGFtc2lrbmlsbWF0IiwiU3VwZXJhZG1pbiIsIlBlbmdndW5hIiwiQWRtaW4gUGFtc2lrbmlsbWF0IC0gTWFzdGVyIERhdGEiXX0sInNpZGlhLW1pY3Jvc2VydmljZXMtcGVydXJpIjp7InJvbGVzIjpbIkRpcmVrdG9yYXQgU0RNLCBUZWtub2xvZ2ksIGRhbiBJbmZvcm1hc2kiLCJEZXBhcnRlbWVuIFBlcmVuY2FuYWFuIGRhbiBVdGlsaXRhcyIsIkRpdmlzaSBQZW5nYW1hbmFuLCBLMyBkYW4gTGluZ2t1bmdhbiIsIlNla3NpIFBlbGF5YW5hbiBLYXJ5YXdhbiIsIlNla3NpIEh1YnVuZ2FuIEluZHVzdHJpYWwiLCJTZWtzaSBSZW11bmVyYXNpIGRhbiBIUklTIiwiRGVwYXJ0ZW1lbiBQZXJzaWFwYW4gZGFuIENldGFrIFByb2R1ayBOb24gVWFuZyIsIkRlcGFydGVtZW4gUGVuanVhbGFuIDEiLCJEZXBhcnRlbWVuIFBlbmdlbG9sYWFuIEFzZXQgUGVydXNhaGFhbiIsIkRpcmVrdG9yYXQgUGVuZ2VtYmFuZ2FuIFVzYWhhIiwiRGVwYXJ0ZW1lbiBQZW1hc2FyYW4iLCJEZXBhcnRlbWVuIEFrdW50YW5zaSIsIkRlcGFydGVtZW4gSHVtYW4gUmVzb3VyY2VzIEJ1c2luZXNzIFBhcnRuZXIgZGFuIEh1YnVuZ2FuIEluZHVzdHJpYWwiLCJTZWtzaSBEZXNhaW4iLCJTZWtzaSBBa3VudGFuc2kgVW11bSIsIkRpZ2l0YWwgU2VydmljZSBPcGVyYXRpb24gRGVwYXJ0bWVudCIsIlBlcnVyaSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkgU2VjdGlvbiIsIlNla3NpIFBlbmdlbWJhbmdhbiBJbmZyYXN0cnVrdHVyIFRla25vbG9naSBJbmZvcm1hc2kiLCJTZWtzaSBQZW5nZW1iYW5nYW4gQXBsaWthc2kgSW50ZXJuYWwiLCJVbml0IFBlbGF5YW5hbiBLZXNlaGF0YW4iLCJTZWtzaSBQZW1lbGloYXJhYW4gQmFuZ3VuYW4gZGFuIFBlbmF0YWFuIExpbmdrdW5nYW4iXX0sInBvcnRhbC1wZXJ1cmkiOnsicm9sZXMiOlsidW1hX3Byb3RlY3Rpb24iXX0sInNpaGVwaS1zc28iOnsicm9sZXMiOlsiVXNlciIsIlRla25pc2kgVEkiXX0sImFkbWluLWNsaSI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiZHVtbXlfcHJvamVjdCI6eyJyb2xlcyI6WyJkYXRhIGFuYWxpcyBzYnUgdWFuZyIsIlF1bW9uIiwiSW50ZXJuYWwgU1BJIiwiZGF0YSBhbmFsaXMgcGVuZ2VtYmFuZ2FuIHVzYWhhIiwiZGF0YSBhbmFsaXMgc2J1IG5vbiB1YW5nIiwiS2VzZWhhdGFuIiwiRGF0YSBBbmFsaXMgU1BJIiwiZGF0YSBhbmFsaXMgZGFmYXN1bSIsImRhdGEgYW5hbGlzIHByb2JpcyBpbnRlcm5hc2lvbmFsIiwic3VwZXIgYWRtaW4iLCJUYXNrZm9yY2UgQ292aWQiLCJTdW1tYXJ5IiwiU2ltYW5kb3IiLCJJVE9DIFBlcnVyaSJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsInZpZXctYXBwbGljYXRpb25zIiwidmlldy1jb25zZW50Iiwidmlldy1ncm91cHMiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsIm1hbmFnZS1jb25zZW50IiwiZGVsZXRlLWFjY291bnQiLCJ2aWV3LXByb2ZpbGUiXX0sImVpbnZvaWNlLXBlcnVyaSI6eyJyb2xlcyI6WyJQZW5qdXJuYWwiLCJQSUMgVW5pdCBLZXJqYSJdfSwibW9uaXRvcmluZy1wZXJ1cmkiOnsicm9sZXMiOlsiQWRtaW5pc3RyYXRvciIsIlVzZXIiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJzaWQiOiIxMDQ0YThlYi0yNjcyLTQxODYtOGZjMi0yNjQyOWE3YmFhZGQiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6Ijc3ODAgV0FIWVUgRURJIFNBTlRPU08iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ3YWh5dS5zYW50b3NvIiwiZ2l2ZW5fbmFtZSI6Ijc3ODAiLCJmYW1pbHlfbmFtZSI6IldBSFlVIEVESSBTQU5UT1NPIiwiZW1haWwiOiIxOTMwLjc3ODBAcGVydXJpLmNvLmlkIn0.vj8uFrq1Qe1WNySR3qJ9Gc8LWy46_BACGd5FvZGZ2Yg';

      // Build the URL with access_token parameter
      // const chatBotBaseUrl = 'http://localhost:3000/';
      const chatBotBaseUrl = 'http://10.30.14.33:31119/';
      const tokenUrl = `${chatBotBaseUrl}?access_token=${encodeURIComponent(SAMPLE_TOKEN)}`;

      // Set the URL in the display and link
      document.getElementById('token-url').textContent = tokenUrl;
      document.getElementById('direct-link').href = tokenUrl;

      function copyUrl() {
        navigator.clipboard
          .writeText(tokenUrl)
          .then(() => {
            alert('URL copied to clipboard!');
          })
          .catch(err => {
            console.error('Failed to copy URL:', err);
          });
      }
    </script>
  </body>
</html>
